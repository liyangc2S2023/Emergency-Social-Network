doctype html
html
    head
        title Join Community
        //- link(rel="stylesheet", type="text/css", href="semantic/dist/semantic.min.css")
        link(rel='stylesheet' href='/css/style.css')
        meta(name='viewport' content='width=device-width, initial-scale=1')
    body
        div(class='container')
            h1(class='h1') Join Community
            form(id="registration-form")
                input(type='text' name='username' id='username' placeholder='username' required)
                input(type='password' name='password' id='password' placeholder='password' required)
                div(id='error-message') 
                button(class='btn-next' type='submit') NEXT

            script.
                import axios from 'axios';
                const form = document.getElementById("registration-form");
                const usernameInput = document.getElementById("username");
                const passwordInput = document.getElementById("password");
                const errorMessage = document.getElementById("error-message");
                form.addEventListener("submit", (event) => {
                    event.preventDefault();
                    let isValid = true;
                    errorMessage.style.display = "none";

                    // TODO: if username exist
                    if (usernameExist) {
                    isValid = false;
                    errorMessage.innerHTML = "• Username exists";
                    }
                    if (passwordInput.value.length < 6) {
                    isValid = false;
                    errorMessage.innerHTML = "• Password must be at least 6 characters long";
                    }

                    if (!isValid) {
                        errorMessage.style.display = "block";
                    } else {
                        // form is valid, submit
                        
                        //- axios.post('/register', {
                        //- username: usernameInput.value,
                        //- password: passwordInput.value
                        //- })
                        //- .then(response => console.log(response.data))
                        //- .catch(error => console.error(error));
                        fetch('/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            username: usernameInput.value,
                            password: passwordInput.value
                        })
                        })
                        .then(res => res.json())
                        .then(data => console.log(data))
                        .catch(error => console.error(error));
                    }
                });


        //- script(src="https://code.jquery.com/jquery-3.1.1.min.js", integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=", crossorigin="anonymous")
        //- script(src="semantic/dist/semantic.min.js")
